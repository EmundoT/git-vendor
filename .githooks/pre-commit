#!/bin/bash
set -e

# Strip git hook env vars so tests create isolated repos
unset GIT_DIR GIT_INDEX_FILE GIT_WORK_TREE GIT_OBJECT_DIRECTORY GIT_ALTERNATE_OBJECT_DIRECTORIES

echo "pre-commit: running go build..."
go build ./...

echo "pre-commit: running go vet..."
go vet ./...

echo "pre-commit: running go test..."
go test -count=1 ./...

echo "pre-commit: all checks passed"
